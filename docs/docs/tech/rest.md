## Принцип построения REST

### Структура URI
```
/api/:entity[/:id][/?:params]
```

Здесь:
- **entity** — название сущности, например, класса или таблицы/представления в БД. Примеры: users, dictionary
- **id opt.** — первичный ключ объекта. Если первичный ключ составной, то части указываются через слэш. Примеры: /users/10, /dictionary/ru/apptitle
- **params opt.** — дополнительные параметры выборки для списочных запросов (фильтрация, сортировка, паджинация и пр.). Форматируются по правилам HTTP GET параметров (функции encodeURIComponent и пр.)

Для разбора части URI до знака вопроса можно использовать регулярку
```
#^/(<entity>([a-z]\-_)+)/?(<id>([a-z][A-Z][0-9]\-_/)*)?$#
```

###  Конечные точки в URL – имя существительное, не глагол
```
/farmers
/crops
```
```
/farmers
/farmers/{farmer_id}
/crops
/crops/{crop_id}
```

###  Версия приложения
```
host/v2/farmers
host/v1/farmers
```

### Методы HTTP
```
GET /:entity/:id — getById
```
В случае успеха сервер возвращает 200 OK с полями объекта в формате JSON в теле ответа (без дополнительного оборачивания в какой-либо объект)

В случае, если объект с такими id не существует, сервер возвращает 404 Not Found

```
POST /:entity — создаёт новый объект типа :entity
```
В теле запроса должны быть перечислены поля объекта в формате JSON без дополнительного заворачивания, т.е. {"field1":"value","field2":10}

В случае успеха сервер должен возвращать 201 Created с пустым телом, но с дополнительным заголовком
```
Location: /:entity/:new_id
```
указывающим на месторасположение созданного объекта.

Возвращать тело ответа чаще всего не требуется, так как у клиента есть все необходимые данные, а id созданного объекта он может получить из Location.

```
PUT /:entity/:id — изменяет объект целиком
```
В запросе должны содержаться все поля изменяемого объекта в формате JSON.

В случае успеха должен возвращать 204 No Data с пустым телом, т.к. у клиента есть все необходимые данные.

```
PATCH /:entity/:id — изменяет отдельные поля объекта
```
В запросе должны быть перечислены только поля, подлежащие изменению.

В случае успеха возвращает 200 OK с телом, аналогичным запросу getById, со всеми полями изменённого объекта.

```
DELETE /:entity/:id — удаляет объект, если он существует.
```
В случае успеха возвращает 204 No Data с пустым телом, т.к. возвращать уже нечего.

### Коды ошибок
- ```200``` — ок
- ```400``` — неправильный запрос
- ```404``` — не найдено результатов
- ```500``` — внутренняя ошибка сервера

### Правила
- Использование кодов символов и html-сущностей не допускается, т.е. режим JSON_UNESCAPED_UNICODE обязателен. 

## Ссылки
- [Принципы построения REST JSON API](https://habr.com/en/post/447322/)
- [REST API Best Practices](https://habr.com/en/post/351890/)